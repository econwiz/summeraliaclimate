-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /user/ab5405/summeraliaclimate/code/energy_uncertainty/figures/plo
> t_3x3_debug_v2_TINV_clim_quadinter.log
  log type:  text
 opened on:  10 Feb 2026, 13:42:30

. 
. di "==============================================================="
===============================================================

. di "START plot_3x3_debug_v2.do | model=`model_name' | `c(current_date)' `c(cu
> rrent_time)'"
START plot_3x3_debug_v2.do | model=TINV_clim_quadinter | 10 Feb 2026 13:42:30

. di "PROJECT=$PROJECT"
PROJECT=/user/ab5405/summeraliaclimate/code/energy_uncertainty

. di "STERD=$STERD"
STERD=/user/ab5405/summeraliaclimate/code/energy_uncertainty/data/regression/st
> ers

. di "EDR=$EDR"
EDR=/user/ab5405/summeraliaclimate/code/energy_consumption/energy_data_release_
> 2021oct21/DATA/regression

. di "FIGDIR=$FIGDIR"
FIGDIR=/user/ab5405/summeraliaclimate/code/energy_uncertainty/figures

. di "==============================================================="
===============================================================

. 
. * ===============================================================
. * MAIN LOOP
. * ===============================================================
. foreach product of local products {
  2.     foreach var of local fuels {
  3. 
.         di ""
  4.         di "==============================================================
> ="
  5.         di "PLOTTING: product=`product' | fuel=`var' | model=`model_name' 
> | year=`year'"
  6.         di "==============================================================
> ="
  7. 
.         * pg for fuel
.         local pg = .
  8.         if ("`var'"=="electricity") local pg = 1
  9.         else if ("`var'"=="other_energy") local pg = 2
 10.         else {
 11.             di as error "Unknown fuel `var' -> cannot set pg"
 12.             continue
 13.         }
 14. 
.         * income knot (ibar)
.         preserve
 15.             use "$EDR/break_data_TINV_clim.dta", clear
 16.             qui summ maxInc_largegpid_`var' if largegpid_`var' == 1
 17.             local ibar = r(max)
 18.         restore
 19.         di "DEBUG: ibar (income knot) = `ibar'"
 20. 
.         * load ster
.         local sterfile "$STERD/FD_FGLS_inter_`model_name'_`product'.ster"
 21.         di "DEBUG: loading ster: `sterfile'"
 22.         cap estimates use "`sterfile'"
 23.         if (_rc) {
 24.             di as error "FAILED: cannot load ster for product=`product' rc
> =`=_rc'"
 25.             continue
 26.         }
 27. 
.         * pull coefficient names
.         matrix b = e(b)
 28.         local bnames : colnames b
 29. 
.         di "DEBUG: number of coefficients in e(b) = " colsof(b)
 30. 
.         di "DEBUG: first `SHOW_FIRST_N_COLNAMES' coefficient colnames:"
 31.         local cc = 0
 32.         foreach nm of local bnames {
 33.             local ++cc
 34.             if (`cc'<=`SHOW_FIRST_N_COLNAMES') di "    [`cc'] `nm'"
 35.         }
 36. 
.         * suffix detection for temp/precip/climate/year terms
.         local SUF ""
 37.         local candidates "_`product' _GMFD _ERA5 _JRA_3Q _MERRA2"
 38.         local found 0
 39. 
.         foreach s of local candidates {
 40.             foreach nm of local bnames {
 41.                 if ("`nm'"=="c.indp`pg'#c.indf1#c.FD_temp1`s'") {
 42.                     local SUF "`s'"
 43.                     local found 1
 44.                 }
 45.             }
 46.             if (`found') continue, break
 47.         }
 48.         di "DEBUG: detected suffix for temp/precip/climate/year terms: `SU
> F'"
 49. 
.         * dump matches
.         if (`SHOW_MATCH_PATTERNS') {
 50.             di "DEBUG: coefficient names matching patterns:"
 51.             foreach nm of local bnames {
 52.                 if (strpos("`nm'","`PAT1'") | strpos("`nm'","`PAT2'") | //
> /
>                     strpos("`nm'","`PAT3'") | strpos("`nm'","`PAT4'") | ///
>                     strpos("`nm'","`PAT5'") | strpos("`nm'","`PAT6'")) {
 53.                     di "    `nm'"
 54.                 }
 55.             }
 56.         }
 57. 
.         * ---------
.         * KEY presence checks WITHOUT programs
.         * ---------
. di "DEBUG: key coefficient presence checks (1=present, 0=missing):"
 58. 
. * Build a pipe-delimited list (NO QUOTES)
. local tests ///
> c.indp`pg'#c.indf1#c.FD_temp1`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_temp2`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_precip1`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_precip2`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_hdd20_TINVtemp1`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_cdd20_TINVtemp1`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_hdd20_TINVtemp2`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_cdd20_TINVtemp2`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_yeartemp1`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_yeartemp2`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_year2temp1`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_year2temp2`SUF'| ///
> c.indp`pg'#c.indf1#c.FD_dc1_lgdppc_MA15I1temp1| ///
> c.indp`pg'#c.indf1#c.FD_dc1_lgdppc_MA15I2temp1| ///
> c.indp`pg'#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2| ///
> c.indp`pg'#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2
 59. 
. * Parse token-by-token safely
. local rest "`tests'"
 60. while ("`rest'" != "") {
 61.     gettoken t rest : rest, parse("|")
 62.     if ("`t'" == "|") continue
 63. 
.     local ok 0
 64.     foreach nm of local bnames {
 65.         if ("`nm'" == "`t'") local ok 1
 66.     }
 67.     di "    `ok'  | `t'"
 68. }
 69. 
.         * ----------------------------------------------------------
.         * Build temperature grid dataset once
.         * ----------------------------------------------------------
.         clear
 70.         set obs 41
 71.         gen double temp1 = _n - 6
 72.         gen double temp2 = temp1^2
 73.         gen byte above20 = (temp1 >= 20)
 74.         gen byte below20 = (temp1 < 20)
 75. 
.         local col_main "`col_`var''"
 76.         local graphicM ""
 77. 
.         * ----------------------------------------------------------
.         * 3x3 loops (income terciles x climate terciles)
.         * ----------------------------------------------------------
.         forval lg=3(-1)1 {
 78.             forval tr=3(-1)1 {
 79. 
.                 local cellid = `lg' + `tr'*100
 80. 
.                 ** --- safe tercile covariates (NO nested preserve) ---
.                 tempname subCDD subHDD subInc
 81.                 
.                 preserve
 82.                     use "$EDR/break_data_TINV_clim.dta", clear
 83.                     keep tpid avgCDD_tpid avgHDD_tpid
 84.                     duplicates drop tpid, force
 85.                     qui su avgCDD_tpid if tpid==`tr'
 86.                     scalar `subCDD' = r(mean)
 87.                     qui su avgHDD_tpid if tpid==`tr'
 88.                     scalar `subHDD' = r(mean)
 89.                 restore
 90.                 
.                 preserve
 91.                     use "$EDR/break_data_TINV_clim.dta", clear
 92.                     keep tgpid avgInc_tgpid
 93.                     duplicates drop tgpid, force
 94.                     qui su avgInc_tgpid if tgpid==`lg'
 95.                     scalar `subInc' = r(mean)
 96.                 restore
 97.                 
.                 local subCDD = `=scalar(`subCDD')'
 98.                 local subHDD = `=scalar(`subHDD')'
 99.                 local subInc = `=scalar(`subInc')'
100.                 
.                 local deltacut = `subInc' - `ibar'
101.                 local ig = 1
102.                 if (`subInc' > `ibar') local ig = 2
103. 
.                 di "DEBUG CELL `cellid': tr=`tr' lg=`lg' | subCDD=`subCDD' su
> bHDD=`subHDD' subInc=`subInc' | ig=`ig' deltacut=`deltacut'"
104. 
.                 * build expression
.                 local line "0"
105. 
.                 foreach k of num 1/2 {
106.                     * base temp (suffix may apply)
.                     local line "`line' + _b[c.indp`pg'#c.indf1#c.FD_temp`k'`S
> UF']*(temp`k' - 20^`k')"
107. 
.                     * climate heterogeneity (suffix may apply)
.                     local line "`line' + above20*_b[c.indp`pg'#c.indf1#c.FD_c
> dd20_TINVtemp`k'`SUF']*`subCDD'*(temp`k' - 20^`k')"
108.                     local line "`line' + below20*_b[c.indp`pg'#c.indf1#c.F
> D_hdd20_TINVtemp`k'`SUF']*`subHDD'*(20^`k' - temp`k')"
109. 
.                     * income spline (UNSUFFIXED by design)
.                     local line "`line' + _b[c.indp`pg'#c.indf1#c.FD_dc1_lgdpp
> c_MA15I`ig'temp`k']*`deltacut'*(temp`k' - 20^`k')"
110. 
.                     * year x temp (suffix may apply) if present and not omitt
> ed
.                     local year_term "c.indp`pg'#c.indf1#c.FD_yeartemp`k'`SUF'
> "
111.                     local year_omit "co.indp`pg'#co.indf1#co.FD_yeartemp`k
> '`SUF'"
112.                     local has_year 0
113.                     local is_omit  0
114.                     foreach nm of local bnames {
115.                         if ("`nm'"=="`year_term'") local has_year 1
116.                         if ("`nm'"=="`year_omit'") local is_omit 1
117.                     }
118.                     if (`has_year' & !`is_omit') {
119.                         local line "`line' + _b[`year_term']*(temp`k' - 20
> ^`k')*`year'"
120.                     }
121. 
.                     * year x income spline (UNSUFFIXED)
.                     local dcyr_term "c.indp`pg'#c.indf1#c.FD_dc1_lgdppc_MA15y
> earI`ig'temp`k'"
122.                     local dcyr_omit "co.indp`pg'#co.indf1#co.FD_dc1_lgdppc
> _MA15yearI`ig'temp`k'"
123.                     local has_dcyr 0
124.                     local is_omit  0
125.                     foreach nm of local bnames {
126.                         if ("`nm'"=="`dcyr_term'") local has_dcyr 1
127.                         if ("`nm'"=="`dcyr_omit'") local is_omit 1
128.                     }
129.                     if (`has_dcyr' & !`is_omit') {
130.                         local line "`line' + _b[`dcyr_term']*`deltacut'*`y
> ear'*(temp`k' - 20^`k')"
131.                     }
132. 
.                     * year^2 x temp (suffix may apply) if present and not omi
> tted
.                     local yr2_term "c.indp`pg'#c.indf1#c.FD_year2temp`k'`SUF'
> "
133.                     local yr2_omit "co.indp`pg'#co.indf1#co.FD_year2temp`k
> '`SUF'"
134.                     local has_yr2 0
135.                     local is_omit 0
136.                     foreach nm of local bnames {
137.                         if ("`nm'"=="`yr2_term'") local has_yr2 1
138.                         if ("`nm'"=="`yr2_omit'") local is_omit 1
139.                     }
140.                     if (`has_yr2' & !`is_omit') {
141.                         local line "`line' + _b[`yr2_term']*(temp`k' - 20^
> `k')*`year'^2"
142.                     }
143. 
.                     * year^2 x income spline (UNSUFFIXED)
.                     local dcy2_term "c.indp`pg'#c.indf1#c.FD_dc1_lgdppc_MA15y
> ear2I`ig'temp`k'"
144.                     local dcy2_omit "co.indp`pg'#co.indf1#co.FD_dc1_lgdppc
> _MA15year2I`ig'temp`k'"
145.                     local has_dcy2 0
146.                     local is_omit  0
147.                     foreach nm of local bnames {
148.                         if ("`nm'"=="`dcy2_term'") local has_dcy2 1
149.                         if ("`nm'"=="`dcy2_omit'") local is_omit 1
150.                     }
151.                     if (`has_dcy2' & !`is_omit') {
152.                         local line "`line' + _b[`dcy2_term']*`deltacut'*`y
> ear'^2*(temp`k' - 20^`k')"
153.                     }
154.                 }
155. 
.                 if (`PRINT_EXPR_CELLID'==`cellid') {
156.                     di "DEBUG: predictnl expression for cell `cellid':"
157.                     di "`line'"
158.                 }
159. 
.                 cap predictnl yhat`cellid' = `line', se(se`cellid') ci(lo`cel
> lid' hi`cellid')
160.                 if (_rc) {
161.                     di as error "ERROR: predictnl failed in cell `cellid' 
> rc=`=_rc'"
162.                     di as error "Expression:"
163.                     di as error "`line'"
164.                     if (`STOP_ON_CELL_ERROR') exit _rc
165.                     continue
166.                 }
167. 
.                 tw ///
>                     rarea hi`cellid' lo`cellid' temp1, col(`col_main'%30) || 
> ///
>                     line yhat`cellid' temp1, lc(`col_main') lw(medthick) || /
> //
>                     , yline(0, lwidth(vthin) lc(black) lp(dash)) ///
>                       xline(20, lwidth(vthin) lc(gray) lp(dot)) ///
>                       xlabel(-5(10)35, labsize(vsmall)) ///
>                       ylabel(, labsize(vsmall) nogrid format(%5.2f)) ///
>                       legend(off) ///
>                       xtitle("") ytitle("") ///
>                       plotregion(color(white)) graphregion(color(white)) ///
>                       nodraw name(Mdbg`cellid', replace)
168. 
.                 local graphicM "`graphicM' Mdbg`cellid'"
169.             }
170.         }
171. 
.         graph combine `graphicM', imargin(zero) ycommon rows(3) ///
>             title("`product': `var'", size(medsmall)) ///
>             subtitle("`model_name' | Year=`year' | SUF=`SUF'", size(vsmall)) 
> ///
>             note("Rows: High→Mid→Low income | Cols: Hot→Mid→Cold climate", si
> ze(vsmall)) ///
>             plotregion(color(white)) graphregion(color(white)) ///
>             name(comb_`product'_`var', replace)
172. 
.         local figname "$FIGDIR/fig_3x3_`var'_`model_name'_`product'_DEBUGv2.p
> df"
173.         graph export "`figname'", replace
174.         di "SAVED: `figname'"
175. 
.         graph drop _all
176.     }
177. }

===============================================================
PLOTTING: product=GMFD | fuel=electricity | model=TINV_clim_quadinter | year=20
> 99
===============================================================
DEBUG: ibar (income knot) = 9.087010383605957
DEBUG: loading ster: /user/ab5405/summeraliaclimate/code/energy_uncertainty/dat
> a/regression/sters/FD_FGLS_inter_TINV_clim_quadinter_GMFD.ster
DEBUG: number of coefficients in e(b) = 57
DEBUG: first 50 coefficient colnames:
    [1] c.indp1#c.indf1#c.FD_temp1
    [2] c.indp1#c.indf1#c.FD_temp2
    [3] c.indp2#c.indf1#c.FD_temp1
    [4] c.indp2#c.indf1#c.FD_temp2
    [5] c.indp1#c.indf1#c.FD_precip1
    [6] c.indp1#c.indf1#c.FD_precip2
    [7] c.indp2#c.indf1#c.FD_precip1
    [8] c.indp2#c.indf1#c.FD_precip2
    [9] c.indp1#c.indf1#c.FD_hdd20_TINVtemp1
    [10] c.indp1#c.indf1#c.FD_cdd20_TINVtemp1
    [11] c.indp1#c.indf1#c.FD_hdd20_TINVtemp2
    [12] c.indp1#c.indf1#c.FD_cdd20_TINVtemp2
    [13] c.indp2#c.indf1#c.FD_hdd20_TINVtemp1
    [14] c.indp2#c.indf1#c.FD_cdd20_TINVtemp1
    [15] c.indp2#c.indf1#c.FD_hdd20_TINVtemp2
    [16] c.indp2#c.indf1#c.FD_cdd20_TINVtemp2
    [17] c.indp1#c.indf1#c.FD_I1lgdppc_MA15
    [18] c.indp1#c.indf1#c.FD_I2lgdppc_MA15
    [19] c.indp2#c.indf1#c.FD_I1lgdppc_MA15
    [20] c.indp2#c.indf1#c.FD_I2lgdppc_MA15
    [21] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp1
    [22] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2
    [23] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp1
    [24] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2
    [25] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I1temp1
    [26] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2
    [27] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I2temp1
    [28] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2
    [29] co.indp1#co.indf1#co.FD_yeartemp1
    [30] co.indp1#co.indf1#co.FD_yeartemp2
    [31] co.indp2#co.indf1#co.FD_yeartemp1
    [32] co.indp2#co.indf1#co.FD_yeartemp2
    [33] c.indp1#c.indf1#c.FD_year2temp1
    [34] c.indp1#c.indf1#c.FD_year2temp2
    [35] c.indp2#c.indf1#c.FD_year2temp1
    [36] c.indp2#c.indf1#c.FD_year2temp2
    [37] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1
    [38] co.indp1#co.indf1#co.FD_dc1_lgdppc_MA15yearI1temp2
    [39] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1
    [40] co.indp1#co.indf1#co.FD_dc1_lgdppc_MA15yearI2temp2
    [41] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1
    [42] co.indp2#co.indf1#co.FD_dc1_lgdppc_MA15yearI1temp2
    [43] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1
    [44] co.indp2#co.indf1#co.FD_dc1_lgdppc_MA15yearI2temp2
    [45] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1
    [46] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp2
    [47] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp1
    [48] c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp2
    [49] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1
    [50] c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp2
DEBUG: detected suffix for temp/precip/climate/year terms: 
DEBUG: coefficient names matching patterns:
    c.indp1#c.indf1#c.FD_temp1
    c.indp1#c.indf1#c.FD_temp2
    c.indp2#c.indf1#c.FD_temp1
    c.indp2#c.indf1#c.FD_temp2
    c.indp1#c.indf1#c.FD_precip1
    c.indp1#c.indf1#c.FD_precip2
    c.indp2#c.indf1#c.FD_precip1
    c.indp2#c.indf1#c.FD_precip2
    c.indp1#c.indf1#c.FD_hdd20_TINVtemp1
    c.indp1#c.indf1#c.FD_cdd20_TINVtemp1
    c.indp1#c.indf1#c.FD_hdd20_TINVtemp2
    c.indp1#c.indf1#c.FD_cdd20_TINVtemp2
    c.indp2#c.indf1#c.FD_hdd20_TINVtemp1
    c.indp2#c.indf1#c.FD_cdd20_TINVtemp1
    c.indp2#c.indf1#c.FD_hdd20_TINVtemp2
    c.indp2#c.indf1#c.FD_cdd20_TINVtemp2
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp1
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp1
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I1temp1
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I2temp1
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2
    co.indp1#co.indf1#co.FD_yeartemp1
    co.indp1#co.indf1#co.FD_yeartemp2
    co.indp2#co.indf1#co.FD_yeartemp1
    co.indp2#co.indf1#co.FD_yeartemp2
    c.indp1#c.indf1#c.FD_year2temp1
    c.indp1#c.indf1#c.FD_year2temp2
    c.indp2#c.indf1#c.FD_year2temp1
    c.indp2#c.indf1#c.FD_year2temp2
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1
    co.indp1#co.indf1#co.FD_dc1_lgdppc_MA15yearI1temp2
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1
    co.indp1#co.indf1#co.FD_dc1_lgdppc_MA15yearI2temp2
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1
    co.indp2#co.indf1#co.FD_dc1_lgdppc_MA15yearI1temp2
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1
    co.indp2#co.indf1#co.FD_dc1_lgdppc_MA15yearI2temp2
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp2
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp1
    c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp2
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp2
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp1
    c.indp2#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp2
DEBUG: key coefficient presence checks (1=present, 0=missing):
    1  | c.indp1#c.indf1#c.FD_temp1
    1  | c.indp1#c.indf1#c.FD_temp2
    1  | c.indp1#c.indf1#c.FD_precip1
    1  | c.indp1#c.indf1#c.FD_precip2
    1  | c.indp1#c.indf1#c.FD_hdd20_TINVtemp1
    1  | c.indp1#c.indf1#c.FD_cdd20_TINVtemp1
    1  | c.indp1#c.indf1#c.FD_hdd20_TINVtemp2
    1  | c.indp1#c.indf1#c.FD_cdd20_TINVtemp2
    0  | c.indp1#c.indf1#c.FD_yeartemp1
    0  | c.indp1#c.indf1#c.FD_yeartemp2
    1  | c.indp1#c.indf1#c.FD_year2temp1
    1  | c.indp1#c.indf1#c.FD_year2temp2
    1  | c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp1
    1  | c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp1
    1  | c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2
    1  | c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2
Number of observations (_N) was 0, now 41.

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 303: tr=3 lg=3 | subCDD=223.8359832763672 subHDD=3925.803955078125 s
> ubInc=9.997271537780762 | ig=2 deltacut=.9102611541748047
ERROR: predictnl failed in cell 303 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*223.8359832763672*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*3925.803955078125*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I2temp1]*.9102611541748047*(temp1 - 20^1) + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1]*.9102611541748047*2099*(temp1 - 
> 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.indp
> 1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp1]*.9102611541748047*2099^2*(temp1 -
>  20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp1#c
> .indf1#c.FD_cdd20_TINVtemp2]*223.8359832763672*(temp2 - 20^2) + below20*_b[c.
> indp1#c.indf1#c.FD_hdd20_TINVtemp2]*3925.803955078125*(20^2 - temp2) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2]*.9102611541748047*(temp2 - 20^2) + 
> _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.indf
> 1#c.FD_dc1_lgdppc_MA15year2I2temp2]*.9102611541748047*2099^2*(temp2 - 20^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 203: tr=2 lg=3 | subCDD=1115.525756835938 subHDD=1178.072631835938 s
> ubInc=9.997271537780762 | ig=2 deltacut=.9102611541748047
ERROR: predictnl failed in cell 203 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*1115.525756835938*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*1178.072631835938*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I2temp1]*.9102611541748047*(temp1 - 20^1) + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1]*.9102611541748047*2099*(temp1 - 
> 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.indp
> 1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp1]*.9102611541748047*2099^2*(temp1 -
>  20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp1#c
> .indf1#c.FD_cdd20_TINVtemp2]*1115.525756835938*(temp2 - 20^2) + below20*_b[c.
> indp1#c.indf1#c.FD_hdd20_TINVtemp2]*1178.072631835938*(20^2 - temp2) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2]*.9102611541748047*(temp2 - 20^2) + 
> _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.indf
> 1#c.FD_dc1_lgdppc_MA15year2I2temp2]*.9102611541748047*2099^2*(temp2 - 20^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 103: tr=1 lg=3 | subCDD=2412.935302734375 subHDD=156.3609924316406 s
> ubInc=9.997271537780762 | ig=2 deltacut=.9102611541748047
ERROR: predictnl failed in cell 103 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*2412.935302734375*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*156.3609924316406*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I2temp1]*.9102611541748047*(temp1 - 20^1) + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI2temp1]*.9102611541748047*2099*(temp1 - 
> 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.indp
> 1#c.indf1#c.FD_dc1_lgdppc_MA15year2I2temp1]*.9102611541748047*2099^2*(temp1 -
>  20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp1#c
> .indf1#c.FD_cdd20_TINVtemp2]*2412.935302734375*(temp2 - 20^2) + below20*_b[c.
> indp1#c.indf1#c.FD_hdd20_TINVtemp2]*156.3609924316406*(20^2 - temp2) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15I2temp2]*.9102611541748047*(temp2 - 20^2) + 
> _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.indf
> 1#c.FD_dc1_lgdppc_MA15year2I2temp2]*.9102611541748047*2099^2*(temp2 - 20^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 302: tr=3 lg=2 | subCDD=223.8359832763672 subHDD=3925.803955078125 s
> ubInc=8.770168304443359 | ig=1 deltacut=-.3168420791625977
ERROR: predictnl failed in cell 302 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*223.8359832763672*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*3925.803955078125*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-.3168420791625977*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-.3168420791625977*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-.3168420791625977*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*223.8359832763672*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*3925.803955078125*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-.3168420791625977*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-.3168420791625977*2099^2*(temp2 - 20
> ^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 202: tr=2 lg=2 | subCDD=1115.525756835938 subHDD=1178.072631835938 s
> ubInc=8.770168304443359 | ig=1 deltacut=-.3168420791625977
ERROR: predictnl failed in cell 202 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*1115.525756835938*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*1178.072631835938*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-.3168420791625977*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-.3168420791625977*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-.3168420791625977*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*1115.525756835938*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*1178.072631835938*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-.3168420791625977*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-.3168420791625977*2099^2*(temp2 - 20
> ^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 102: tr=1 lg=2 | subCDD=2412.935302734375 subHDD=156.3609924316406 s
> ubInc=8.770168304443359 | ig=1 deltacut=-.3168420791625977
ERROR: predictnl failed in cell 102 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*2412.935302734375*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*156.3609924316406*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-.3168420791625977*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-.3168420791625977*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-.3168420791625977*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*2412.935302734375*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*156.3609924316406*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-.3168420791625977*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-.3168420791625977*2099^2*(temp2 - 20
> ^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 301: tr=3 lg=1 | subCDD=223.8359832763672 subHDD=3925.803955078125 s
> ubInc=7.497846126556396 | ig=1 deltacut=-1.589164257049561
DEBUG: predictnl expression for cell 301:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*223.8359832763672*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*3925.803955078125*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-1.589164257049561*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-1.589164257049561*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-1.589164257049561*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*223.8359832763672*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*3925.803955078125*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-1.589164257049561*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-1.589164257049561*2099^2*(temp2 - 20
> ^2)
ERROR: predictnl failed in cell 301 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*223.8359832763672*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*3925.803955078125*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-1.589164257049561*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-1.589164257049561*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-1.589164257049561*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*223.8359832763672*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*3925.803955078125*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-1.589164257049561*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-1.589164257049561*2099^2*(temp2 - 20
> ^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 201: tr=2 lg=1 | subCDD=1115.525756835938 subHDD=1178.072631835938 s
> ubInc=7.497846126556396 | ig=1 deltacut=-1.589164257049561
ERROR: predictnl failed in cell 201 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*1115.525756835938*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*1178.072631835938*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-1.589164257049561*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-1.589164257049561*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-1.589164257049561*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*1115.525756835938*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*1178.072631835938*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-1.589164257049561*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-1.589164257049561*2099^2*(temp2 - 20
> ^2)

Duplicates in terms of tpid

(4,675 observations deleted)

Duplicates in terms of tgpid

(4,675 observations deleted)
DEBUG CELL 101: tr=1 lg=1 | subCDD=2412.935302734375 subHDD=156.3609924316406 s
> ubInc=7.497846126556396 | ig=1 deltacut=-1.589164257049561
ERROR: predictnl failed in cell 101 rc=111
Expression:
0 + _b[c.indp1#c.indf1#c.FD_temp1]*(temp1 - 20^1) + above20*_b[c.indp1#c.indf1#
> c.FD_cdd20_TINVtemp1]*2412.935302734375*(temp1 - 20^1) + below20*_b[c.indp1#c
> .indf1#c.FD_hdd20_TINVtemp1]*156.3609924316406*(20^1 - temp1) + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15I1temp1]*-1.589164257049561*(temp1 - 20^1) + _b[c.i
> ndp1#c.indf1#c.FD_dc1_lgdppc_MA15yearI1temp1]*-1.589164257049561*2099*(temp1 
> - 20^1) + _b[c.indp1#c.indf1#c.FD_year2temp1]*(temp1 - 20^1)*2099^2 + _b[c.in
> dp1#c.indf1#c.FD_dc1_lgdppc_MA15year2I1temp1]*-1.589164257049561*2099^2*(temp
> 1 - 20^1) + _b[c.indp1#c.indf1#c.FD_temp2]*(temp2 - 20^2) + above20*_b[c.indp
> 1#c.indf1#c.FD_cdd20_TINVtemp2]*2412.935302734375*(temp2 - 20^2) + below20*_b
> [c.indp1#c.indf1#c.FD_hdd20_TINVtemp2]*156.3609924316406*(20^2 - temp2) + _b[
> c.indp1#c.indf1#c.FD_dc1_lgdppc_MA15I1temp2]*-1.589164257049561*(temp2 - 20^2
> ) + _b[c.indp1#c.indf1#c.FD_year2temp2]*(temp2 - 20^2)*2099^2 + _b[c.indp1#c.
> indf1#c.FD_dc1_lgdppc_MA15year2I1temp2]*-1.589164257049561*2099^2*(temp2 - 20
> ^2)
unrecognized command
r(199);

end of do-file
r(199);
